--// final_script_immediate_webhook_ui_plus_addgems.lua
repeat wait() until game.Players.LocalPlayer and game.Players.LocalPlayer:WaitForChild("PlayerGui"):WaitForChild("spawn_units")
repeat wait() until game.Players.LocalPlayer:FindFirstChild("_stats")
--------------------------------------------------------------------------------
-- (A) ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
--------------------------------------------------------------------------------

if not game:IsLoaded() then
    game.Loaded:Wait()
end

local Players    = game:GetService("Players")
local RunService = game:GetService("RunService")
local HttpService= game:GetService("HttpService")
local player     = Players.LocalPlayer
local ThumbnailURL = nil

local ThumbnailRequest = http.request(
    {
        Url = "https://thumbnails.roblox.com/v1/users/avatar?userIds="..tostring(game.Players.LocalPlayer.UserId).."&size=420x420&format=Png&isCircular=false",
        Method = "GET",
        Headers = {
            ["Content-Type"] = "application/json"
        },
    }
)
ThumbnailURL = (game:GetService("HttpService"):JSONDecode(ThumbnailRequest.Body))["data"][1]["imageUrl"]
print(ThumbnailURL)


--------------------------------------------------------------------------------
-- (B) ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® Webhook ‡∏´‡∏•‡∏±‡∏Å + WebhookEnd
--------------------------------------------------------------------------------

_G.Webhook    = "https://discord.com/api/webhooks/1283623950017892382/2y8Qax0xHlH-UYlDulC9-2GCsG_qjIqswU6rt-q9fGR3ix9o7SfDGXR-9lL6PqB64jbb"
local WebhookEnd = "https://discord.com/api/webhooks/1099711689450066060/_0cDSkNN4gfosy0oL-5i9Rg8BXF0hQ2Bu4d3H-AlCuZf1T8_3hL-qxi3X1mt1DrDtLcV"

--------------------------------------------------------------------------------
-- (C) ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå JSON = "<PlayerName>_SHOPData.json"
--------------------------------------------------------------------------------

local SettingsFile = player.Name .. "_SHOPData.json"

-- ‡∏Ñ‡πà‡∏≤ Default ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå
local DefaultData = {
    MaxGems       = 0,
    DiscordID     = "",
    OldGems       = 0,
    IsSended      = false,
    AddGemsWanted = 0,

    SavedLevel    = "???",  -- <--- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (default ???)
}

--------------------------------------------------------------------------------
-- (D) ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô load/save ‡πÑ‡∏ü‡∏•‡πå JSON
--------------------------------------------------------------------------------

local function loadSettings()
    if isfile and isfile(SettingsFile) then
        local content = readfile(SettingsFile)
        local success, data = pcall(function()
            return HttpService:JSONDecode(content)
        end)
        if success and type(data)=="table" then
            return data
        else
            warn("‡πÑ‡∏ü‡∏•‡πå JSON ‡πÄ‡∏™‡∏µ‡∏¢‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö => ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà: " .. SettingsFile)
        end
    end
    -- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏£‡∏∑‡∏≠ decode ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô => ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
    if writefile then
        writefile(SettingsFile, HttpService:JSONEncode(DefaultData))
    else
        warn("Executor ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö writefile => loadSettings ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß")
    end
    return DefaultData
end

local function saveSettings(tbl)
    if writefile then
        local s = HttpService:JSONEncode(tbl)
        writefile(SettingsFile, s)
    else
        warn("Executor ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö writefile => saveSettings ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß")
    end
end

--------------------------------------------------------------------------------
-- (E) ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå + ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤
--------------------------------------------------------------------------------

local LocalData = loadSettings()

local MaxGems       = LocalData.MaxGems or 0
local DiscordID     = LocalData.DiscordID or ""
local OldGems       = LocalData.OldGems or 0
local IsSended      = LocalData.IsSended or false
local AddGemsWanted = LocalData.AddGemsWanted or 0
local SavedLevel    = LocalData.SavedLevel or "???"

--------------------------------------------------------------------------------
-- (F) ‡∏•‡∏≠‡∏á‡∏´‡∏≤ _stats.gem_amount (‡∏Å‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏ö‡∏•‡πá‡∏≠‡∏Å)
--------------------------------------------------------------------------------

local gemObj
local currentGems = 0
pcall(function()
    local stats = player:WaitForChild("_stats", 5)
    gemObj = stats and stats:WaitForChild("gem_amount", 2)
end)
if gemObj and typeof(gemObj.Value)=="number" then
    currentGems = gemObj.Value
else
    warn("‡πÑ‡∏°‡πà‡∏û‡∏ö gem_amount => currentGems=0")
end



-- ‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î gold_amount ‡πÅ‡∏ö‡∏ö pcall ‡∏Å‡∏±‡∏ô error
local stats = player:WaitForChild("_stats", 5)
local goldObj
local currentGold = 0
pcall(function()
    goldObj = stats and stats:WaitForChild("gold_amount", 2)
end)
if goldObj and typeof(goldObj.Value)=="number" then
    currentGold = goldObj.Value
else
    warn("‡πÑ‡∏°‡πà‡∏û‡∏ö gold_amount => currentGold=0, ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠ field ‡πÉ‡∏ô _stats ‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ")
end

print("Current gold:", currentGold)

--------------------------------------------------------------------------------
-- (G) ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ Level (spawn_units) + ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡∏á JSON ‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡πÄ‡∏à‡∏≠
--------------------------------------------------------------------------------

local function TryGetLevelOrSaved()
    local foundLevel = nil
    pcall(function()
        local spawnUnits = player:WaitForChild("PlayerGui", 5):WaitForChild("spawn_units", 2)
        local lvlObj = spawnUnits.Lives.Main.Desc:WaitForChild("Level", 2)
        foundLevel = lvlObj.Text
    end)
    -- ‡∏ñ‡πâ‡∏≤ foundLevel == nil => ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏´‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ => ‡πÉ‡∏ä‡πâ SavedLevel ‡πÄ‡∏î‡∏¥‡∏°
    if not foundLevel then
        return SavedLevel  -- ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ
    end
    -- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ foundLevel => ‡∏ï‡∏±‡∏î "Level " ‡∏≠‡∏≠‡∏Å
    local newLV = string.gsub(foundLevel, "Level ", "")
    -- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï LocalData + ‡πÄ‡∏ã‡∏ü‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå
    LocalData.SavedLevel = newLV
    saveSettings(LocalData)
    return newLV
end

local currentLevel = TryGetLevelOrSaved()

--------------------------------------------------------------------------------
-- (H) ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á Webhook ‡πÅ‡∏•‡∏∞ WebhookEnd
--------------------------------------------------------------------------------
local LogoURLs = "https://cdn.discordapp.com/attachments/1082245350166892554/1323232911272448010/logo.png?ex=6773c42e&is=677272ae&hm=73bbda78feab2829609946c3dced71b8e6f9f544c3888a019a1ae5f304332588&"


local function sendWebhook(title, desc)
    local req = http_request or request or HttpPost or syn and syn.request
    if not req then
        warn("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô request => sendWebhook ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß")
        return
    end
    local payload = {
        content = "",
        embeds = {{
            title = title,
            description = desc,
            color = 0x00FF99,
            image = { url = ThumbnailURL },
            footer = { icon_url = LogoURLs , text = "PLaNS SHOP"},
            timestamp = DateTime.now():ToIsoDate()
        }}
    }
    req({
        Url = _G.Webhook,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = HttpService:JSONEncode(payload)
    })
end
--------------------------------------------------------------------------------
local function sendWebhook2(title, desc)
    local req = http_request or request or HttpPost or syn and syn.request
    if not req then
        warn("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô request => sendWebhook ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß")
        return
    end
    local payload = {
        content = "<@"..DiscordID.."> <@&1006505817769521177>",
        embeds = {{
            title = title,
            description = desc,
            color = 0xFF1493,
            image = { url = ThumbnailURL },
            footer = { icon_url = LogoURLs , text = "PLaNS SHOP"},
            timestamp = DateTime.now():ToIsoDate()
        }}
    }
    req({
        Url = _G.Webhook,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = HttpService:JSONEncode(payload)
    })
end
--------------------------------------------------------------------------------
local function sendWebhookEnd(title, desc)
    local req = http_request or request or HttpPost or syn and syn.request
    if not req then
        warn("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô request => sendWebhookEnd ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß")
        return
    end
    local payload = {
        content = "<@"..DiscordID.."> <@&1006505817769521177>", 
        embeds = {{
            title = title,
            description = desc,
            color = 0xFF1493,
            image = { url = ThumbnailURL },
            footer = { icon_url = LogoURLs , text = "PLaNS SHOP"},
            timestamp = DateTime.now():ToIsoDate()
        }}
    }
    req({
        Url = WebhookEnd,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = HttpService:JSONEncode(payload)
    })
end

--------------------------------------------------------------------------------
-- (I) ‡∏™‡πà‡∏á Webhook ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ + ‡πÄ‡∏ä‡πá‡∏Ñ‡∏õ‡∏£‡∏±‡∏ö MaxGems
--------------------------------------------------------------------------------

sendWebhook(
    "PLaNS x ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏û‡∏ä‡∏£",
    string.format(
        "üîí„ÉªUsername : ||**%s**||\n" ..
        "```md\n#Profile\n" ..
        "üü°„Éª‡∏ó‡∏≠‡∏á : %d\n" ..
        "üß™„Éª‡πÄ‡∏•‡πÄ‡∏ß‡∏• : %s\n" ..
        "üíé„Éª‡πÄ‡∏û‡∏ä‡∏£‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ : %d\n" ..
        "- ‡πÄ‡∏û‡∏ä‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ü‡∏≤‡∏° : [%d|%d]\n" ..
        "```\n" ..
        "```- ‡∏ü‡∏≤‡∏°‡πÄ‡∏û‡∏ä‡∏£‡∏à‡∏≥‡∏ô‡∏ß‡∏ô : %d ‡πÄ‡∏û‡∏ä‡∏£ üíé ```",
        player.Name,
        currentGold,
        currentLevel,
        currentGems,
        currentGems,
        MaxGems,
        AddGemsWanted
    )
)

-- ‡∏ñ‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏ä‡∏£ => ‡∏´‡∏±‡∏Å‡∏à‡∏≤‡∏Å MaxGems
if currentGems < OldGems then
    local diff = OldGems - currentGems
    LocalData.MaxGems = math.max(LocalData.MaxGems - diff, 0)
    print("‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏ä‡∏£", diff, "=> MaxGems =", LocalData.MaxGems)
elseif currentGems > OldGems then
    print("‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏ä‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°", currentGems - OldGems, "=> OldGems:", OldGems, "->", currentGems)
end
LocalData.OldGems = currentGems

-- ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÄ‡∏õ‡πâ‡∏≤ => ‡∏™‡πà‡∏á WebhookEnd
if currentGems >= LocalData.MaxGems
   and LocalData.MaxGems > 0
   and (not LocalData.IsSended)
then
    sendWebhookEnd(
        "- ‡∏ü‡∏≤‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞ <a:9828pinkpixelheart:1021714314446508082>",
        string.format(
            "üîí„ÉªUsername : ||**%s**||\n" ..
            "```md\n#Profile\n" ..
            "üíé„Éª‡πÄ‡∏û‡∏ä‡∏£‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ : %d\n" ..
            "üü°„Éª‡∏ó‡∏≠‡∏á : %d\n" ..
            "üß™„Éª‡πÄ‡∏•‡πÄ‡∏ß‡∏• : %s\n" ..
            "- ‡πÄ‡∏û‡∏ä‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß : [%d|%d]\n" ..
            "```\n" ..
            "```md\n#‡πÅ‡∏û‡∏Ñ‡πÄ‡∏Å‡∏à‡∏ó‡∏µ‡πà‡∏à‡πâ‡∏≤‡∏á\n- ‡∏ü‡∏≤‡∏°‡πÄ‡∏û‡∏ä‡∏£‡∏à‡∏≥‡∏ô‡∏ß‡∏ô : %d ‡πÄ‡∏û‡∏ä‡∏£ üíé ```\n\n",
            "‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πâ‡∏≤¬∑ ö‚ô°…û¬∑\n<#1009544224720568371>\n<#1021662378250752080>\n\n<a:emoji_98_jk:1054831096929452042> ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ô‡πâ‡∏≤ <a:8699rightrainbowstar:1054740408434966588>",
            player.Name,
            currentGems,
            currentGold,
            currentLevel,
            currentGems,
            MaxGems,
            AddGemsWanted
        )
    )
    LocalData.IsSended = true
end

saveSettings(LocalData)

--------------------------------------------------------------------------------
-- (J) ‡∏™‡∏£‡πâ‡∏≤‡∏á UI (Lib): "Add Gems" => MaxGems = currentGems + AddGemsWanted
--------------------------------------------------------------------------------

local Library = loadstring(game:HttpGet('https://raw.githubusercontent.com/EmiyaSanZ/Lib/main/UI'))()
local Window  = Library:CreateWindow({
    Title    = "PLaNS x SHOP",
    Center   = true,
    AutoShow = false,
})

local MainTab     = Window:AddTab("PLaNS x SHOP")
local SettingsBox = MainTab:AddLeftGroupbox("Settings")

-- Input ‚ÄúAdd Gems‚Äù
local addGemsInput = SettingsBox:AddInput('Add Gems', {
    Numeric     = true,
    Finished    = false,
    Text        = '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏µ‡πà‡πÄ‡∏û‡∏ä‡∏£?',
    Placeholder = 'Ex: 20000',
    Default     = AddGemsWanted
})

-- Input ‚ÄúDiscord ID‚Äù
local di = SettingsBox:AddInput('Discord ID', {
    Numeric     = false,
    Finished    = false,
    Text        = 'Discord ID',
    Placeholder = 'Ex: 12345678',
    Default     = DiscordID
})

-- ‡∏õ‡∏∏‡πà‡∏° Save
SettingsBox:AddButton('Save Settings', function()
    local addGemsNum = tonumber(addGemsInput.Value) or 0
    LocalData.MaxGems       = currentGems + math.max(addGemsNum, 0)
    LocalData.DiscordID     = di.Value
    LocalData.AddGemsWanted = addGemsNum
    LocalData.IsSended      = false

    if typeof(LocalData.OldGems) ~= "number" then
        LocalData.OldGems = 0
    end
    if LocalData.OldGems == 0 then
        LocalData.OldGems = currentGems
    end

    saveSettings(LocalData)

    -- << ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ DiscordID ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏î‡πâ‡∏ß‡∏¢ >>
    DiscordID = di.Value    -- <<--- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
    
    print(string.format(
        "[Save] AddGemsWanted=%d => MaxGems=%d, DiscordID=%s",
        addGemsNum, LocalData.MaxGems, LocalData.DiscordID
    ))
end)

local dd = LocalData.DiscordID or ""
-- ‡∏õ‡∏∏‡πà‡∏° Test
SettingsBox:AddButton('Test Webhook', function()
    local testStr = string.format(
        "‡∏ó‡∏î‡∏™‡∏≠‡∏ö!\n‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô : ||%s||\n‡∏ó‡∏≠‡∏á : %d\n‡πÄ‡∏•‡πÄ‡∏ß‡∏• : %s\n‡πÄ‡∏û‡∏ä‡∏£‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ : %d\n‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ : %d\n\n```md\n#‡πÅ‡∏û‡∏Ñ‡πÄ‡∏Å‡∏à‡∏ó‡∏µ‡πà‡∏à‡πâ‡∏≤‡∏á\n- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô : %d ‡πÄ‡∏û‡∏ä‡∏£```",
        player.Name,
        currentGold,
        currentLevel,  -- ‡πÉ‡∏ä‡πâ Level ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡πÄ‡∏à‡∏≠)
        currentGems,
        LocalData.MaxGems,
        LocalData.AddGemsWanted
    )
    sendWebhook2("<a:alert:1021734820461674527> ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÜ <a:alert:1021734820461674527>", testStr .. "<@"..dd..">")
end)

-- Toggle White Screen
SettingsBox:AddLabel("Optional UI Toggles")
local WhiteScreenToggle = SettingsBox:AddToggle('White Screen', {
    Text    = 'Toggle White Screen',
    Default = true,
})
WhiteScreenToggle:OnChanged(function(v)
    RunService:Set3dRenderingEnabled(not v)
end)

--------------------------------------------------------------------------------
-- (K) ‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô Toggle UI
--------------------------------------------------------------------------------

do
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "UI_ToggleButton"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Global
    ScreenGui.DisplayOrder = 9999

    -- ‡πÉ‡∏™‡πà Parent = PlayerGui
    ScreenGui.Parent = player:WaitForChild("PlayerGui")

    local ToggleButton = Instance.new("ImageButton")
    ToggleButton.Name = "ToggleButton"
    ToggleButton.Size = UDim2.new(0, 50, 0, 50)
    ToggleButton.Position = UDim2.new(0, 10, 0.5, -25)
    ToggleButton.BackgroundTransparency = 1
    ToggleButton.Image = "rbxassetid://3570695787"
    ToggleButton.Parent = ScreenGui

    ToggleButton.MouseButton1Click:Connect(function()
        Library.Toggle()
    end)
end

print("Script loaded! ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ spawn_units => ‡πÉ‡∏ä‡πâ Level ‡πÄ‡∏î‡∏¥‡∏°‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå SavedLevel ‡πÅ‡∏ó‡∏ô ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏´‡∏≤‡πÄ‡∏à‡∏≠‡πÉ‡∏´‡∏°‡πà.") 
